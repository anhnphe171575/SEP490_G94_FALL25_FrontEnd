{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file:///G:/SEP/frontend/softcapstone/ultis/axios.js"],"sourcesContent":["// lib/axios.js\r\nimport axios from 'axios';\r\nimport { useState } from 'react';\r\n\r\n// Debug log để kiểm tra env\r\n\r\n\r\nconst axiosInstance = axios.create({\r\n  baseURL: process.env.NEXT_PUBLIC_API_URL,\r\n  timeout: 30000,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n    'Accept': 'application/json'\r\n  },\r\n});\r\n\r\n// Request interceptor\r\naxiosInstance.interceptors.request.use(\r\n  (config) => {\r\n    const token = typeof window !== 'undefined' ? sessionStorage.getItem('token') : null;\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    \r\n    // Don't set Content-Type for FormData, let axios handle it automatically\r\n    if (config.data instanceof FormData) {\r\n      delete config.headers['Content-Type'];\r\n    }\r\n    \r\n    if (process.env.NODE_ENV === 'development') {\r\n    \r\n    }\r\n    \r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor\r\naxiosInstance.interceptors.response.use(\r\n  (response) => {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      \r\n    }\r\n    return response;\r\n  },\r\n  (error) => {\r\n    if (process.env.NODE_ENV === 'development') {\r\n    }\r\n    \r\n    // Xử lý lỗi chung\r\n    if (error.response?.status === 401) {\r\n      if (typeof window !== 'undefined') {\r\n        localStorage.removeItem('token');\r\n        window.location.href = '/login';\r\n      }\r\n    }\r\n    if (error.response?.status === 403) {\r\n      if (typeof window !== 'undefined') {\r\n        window.location.href = '/not-found';\r\n      }\r\n    }\r\n    \r\n    if (error.response?.status === 500) {\r\n      console.error('Server Error:', error.response.data);\r\n    }\r\n    \r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default axiosInstance;\r\n\r\n// Export các method thường dùng\r\nexport const api = {\r\n  get: (url, config) => axiosInstance.get(url, config),\r\n  post: (url, data, config) => axiosInstance.post(url, data, config),\r\n  put: (url, data, config) => axiosInstance.put(url, data, config),\r\n  patch: (url, data, config) => axiosInstance.patch(url, data, config),\r\n  delete: (url, config) => axiosInstance.delete(url, config),\r\n  \r\n  // Review API methods\r\n  reviews: {\r\n    // Create a new review\r\n    create: (reviewData) => axiosInstance.post('/reviews', reviewData),\r\n    \r\n    // Get all reviews\r\n    getAll: () => axiosInstance.get('/reviews'),\r\n    \r\n    // Get reviews for a specific product\r\n    getByProduct: (productId) => axiosInstance.get(`/reviews/product/${productId}`),\r\n    \r\n    // Get unreviewed products for a user\r\n    getUnreviewed: (productId) => axiosInstance.get(`/reviews/unreviewed/${productId}`),\r\n    \r\n    // Update a review\r\n    update: (reviewId, reviewData) => axiosInstance.put(`/reviews/${reviewId}`, reviewData),\r\n    \r\n    // Delete a review\r\n    delete: (reviewId) => axiosInstance.delete(`/reviews/${reviewId}`),\r\n  },\r\n};\r\n\r\n// Utility functions cho các trường hợp đặc biệt\r\nexport const apiUtils = {\r\n  // Upload file\r\n  uploadFile: (url, file, onUploadProgress) => {\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    \r\n    return axiosInstance.post(url, formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n      onUploadProgress,\r\n    });\r\n  },\r\n  \r\n  // Download file\r\n  downloadFile: async (url, filename) => {\r\n    try {\r\n      const response = await axiosInstance.get(url, {\r\n        responseType: 'blob',\r\n      });\r\n      \r\n      const blob = new Blob([response.data]);\r\n      const downloadUrl = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = downloadUrl;\r\n      link.download = filename;\r\n      link.click();\r\n      window.URL.revokeObjectURL(downloadUrl);\r\n    } catch (error) {\r\n      console.error('Download failed:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Create review\r\n  createReview: async (reviewData) => {\r\n    try {\r\n      const response = await axiosInstance.post('/reviews', reviewData);\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Create review failed:', error);\r\n      throw error;\r\n    }\r\n  },\r\n};\r\n\r\n// Custom hooks cho React components\r\nexport const useApi = () => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  \r\n  const request = async (apiCall) => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const response = await apiCall();\r\n      return response.data;\r\n    } catch (err) {\r\n      setError(err);\r\n      throw err;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  return { request, loading, error };\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":["file:///G:/SEP/frontend/softcapstone/src/app/login/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport axiosInstance from \"../../../ultis/axios\";\r\n\r\nexport default function LoginPage() {\r\n  const router = useRouter();\r\n  const googleBtnRef = useRef<HTMLDivElement | null>(null);\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // Initialize Google Identity Services\r\n  useEffect(() => {\r\n    const clientId = process.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID;\r\n    if (!clientId) return; // silently skip if not configured\r\n\r\n    const loadScript = () => {\r\n      if (document.getElementById(\"google-identity\")) return initGoogle();\r\n      const script = document.createElement(\"script\");\r\n      script.src = \"https://accounts.google.com/gsi/client\";\r\n      script.async = true;\r\n      script.defer = true;\r\n      script.id = \"google-identity\";\r\n      script.onload = initGoogle;\r\n      document.body.appendChild(script);\r\n    };\r\n\r\n    const initGoogle = () => {\r\n      // @ts-ignore\r\n      if (!window.google || !google.accounts || !google.accounts.id) return;\r\n      // @ts-ignore\r\n      google.accounts.id.initialize({\r\n        client_id: clientId,\r\n        callback: handleGoogleResponse,\r\n        ux_mode: \"popup\",\r\n      });\r\n      if (googleBtnRef.current) {\r\n        // @ts-ignore\r\n        google.accounts.id.renderButton(googleBtnRef.current, {\r\n          theme: \"outline\",\r\n          size: \"large\",\r\n          shape: \"pill\",\r\n          text: \"signin_with\",\r\n        });\r\n      }\r\n    };\r\n\r\n    loadScript();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const handleGoogleResponse = async (response: any) => {\r\n    try {\r\n      setError(null);\r\n      setLoading(true);\r\n      const idToken = response?.credential;\r\n      if (!idToken) throw new Error(\"Không nhận được phản hồi từ Google\");\r\n      const res = await axiosInstance.post(\"/api/auth/google\", { idToken });\r\n      const token = res.data?.token;\r\n      if (token) {\r\n        sessionStorage.setItem(\"token\", token);\r\n        localStorage.setItem(\"token\", token); // keep both for existing interceptor behavior\r\n      }\r\n      router.replace(\"/dashboard\");\r\n    } catch (e: any) {\r\n      setError(e?.response?.data?.message || e?.message || \"Đăng nhập Google thất bại\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const onSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const res = await axiosInstance.post(\"/api/auth/login\", { email, password });\r\n      const token = res.data?.token;\r\n      if (token) {\r\n        sessionStorage.setItem(\"token\", token);\r\n        localStorage.setItem(\"token\", token);\r\n      }\r\n      router.replace(\"/dashboard\");\r\n    } catch (e: any) {\r\n      setError(e?.response?.data?.message || \"Đăng nhập thất bại\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center p-6\">\r\n      <div className=\"w-full max-w-md card rounded-xl p-6 shadow-sm\">\r\n        <h1 className=\"text-2xl font-semibold mb-6\" style={{color:'var(--primary)'}}>Đăng nhập</h1>\r\n\r\n        {error ? (\r\n          <div className=\"mb-4 text-red-600 text-sm\">{error}</div>\r\n        ) : null}\r\n\r\n        <form onSubmit={onSubmit} className=\"space-y-4\">\r\n          <div className=\"space-y-1\">\r\n            <label htmlFor=\"email\" className=\"block text-sm\">Email</label>\r\n            <input\r\n              id=\"email\"\r\n              type=\"email\"\r\n              required\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              className=\"w-full border rounded-lg px-3 py-2 focus:outline-none\"\r\n              placeholder=\"you@example.com\"\r\n            />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label htmlFor=\"password\" className=\"block text-sm\">Mật khẩu</label>\r\n            <input\r\n              id=\"password\"\r\n              type=\"password\"\r\n              required\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n              className=\"w-full border rounded-lg px-3 py-2 focus:outline-none\"\r\n              placeholder=\"••••••••\"\r\n            />\r\n          </div>\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            className=\"w-full btn-primary rounded-lg py-2 disabled:opacity-60\"\r\n          >\r\n            {loading ? \"Đang xử lý...\" : \"Đăng nhập\"}\r\n          </button>\r\n        </form>\r\n\r\n        <div className=\"my-6 flex items-center\">\r\n          <div className=\"flex-1 h-px\" style={{background:'var(--border)'}} />\r\n          <span className=\"px-3 text-xs\" style={{color:'var(--primary-700)'}}>hoặc</span>\r\n          <div className=\"flex-1 h-px\" style={{background:'var(--border)'}} />\r\n        </div>\r\n\r\n        <div className=\"flex justify-center\">\r\n          <div ref={googleBtnRef} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}